{% extends 'base/base-nav.html' %}

{% block extra_head %}
<script>
    function confirmDelete() {
        return confirm("Are you sure you want to delete this item?");
    }
</script>
{% endblock %}

{% block title %}{{ viewing_user.username }}{% endblock %}

{% block content %}
<div class="container mx-auto p-4" data-theme="light">
    <!-- User Details Card -->
    <div class="card lg:card-side bg-base-200 shadow-xl mb-8">
        <figure class="px-10 pt-10">
            {% if viewing_user.image %}
            <img src="{{ viewing_user.image.url }}" alt="{{ viewing_user.first_name }} {{ viewing_user.last_name }}" class="rounded-full w-48 h-48 object-cover" />
            {% else %}
            <img src="https://t3.ftcdn.net/jpg/09/64/89/20/360_F_964892089_vioRltmAxaoQEBLtYtChVBxIzDWwhA3T.jpg" alt="{{ viewing_user.first_name }} {{ viewing_user.last_name }}" class="rounded-full w-48 h-48 object-cover" />
            {% endif %}
        </figure>
        <div class="card-body">
            <h2 class="card-title text-3xl">{{ viewing_user.first_name }} {{ viewing_user.last_name }}</h2>
            <p><span class="font-bold">Email:</span> {{ viewing_user.email }}</p>
            <p><span class="font-bold">Year level:</span> {{ viewing_user.year_level }}</p>
            <p><span class="font-bold">Degree:</span> {{ viewing_user.get_degree_display }}</p>
            <p><span class="font-bold">Joined:</span> {{ viewing_user.date_joined|date:"F d, Y" }}</p>
        </div>
    </div>

    <!-- Statistics Row -->
    <div class="stats shadow bg-base-200 w-full mb-8">
        <div class="stat">
            <div class="stat-figure text-primary">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            </div>
            <div class="stat-title">Lost Items</div>
            <div class="stat-value text-primary">{{ lost_count }}</div>
        </div>
        
        <div class="stat">
            <div class="stat-figure text-secondary">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
            </div>
            <div class="stat-title">Found Items</div>
            <div class="stat-value text-secondary">{{ found_count }}</div>
        </div>
    </div>

    <!-- Tabs for Lost and Found Items -->
    <div class="tabs tabs-boxed mb-4 bg-base-200">
        <a class="tab tab-active" id="lost-items-tab" onclick="openTab('lost-items')">Lost Items</a>
        <a class="tab" id="found-items-tab" onclick="openTab('found-items')">Found Items</a>
    </div>

    <!-- Lost Items Tab Content -->
    <div id="lost-items" class="tab-content">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for item in viewing_user.reported_items.all %}
            {% if item.type == "Lost" %}
            <a class="no-underline block" href="{% url 'view_item' item.id %}">
                <div class="card card-compact bg-base-100 max-w-96 shadow-xl transform transition-transform duration-150 hover:scale-105">
                    <figure class="m-0">
                        <img class="w-full h-40 object-cover" src="{{ item.image.url }}" alt="{{ item.name }}" />
                    </figure>
                    <div class="p-4">
                        <p class="m-0">{{ item.user.username }}</p>
                        <h2 class="text-2xl font-bold">{{ item.name }}</h2>
                        <p class="m-0">{{ item.location }}</p>
                        <p class="m-0 text-sm text-gray-500">Reported: {{ item.date|date:"F d, Y" }}</p>
                    </div>
                </div>
            </a>
            {% endif %}
            {% endfor %}
        </div>
    </div>

    <!-- Found Items Tab Content -->
    <div id="found-items" class="tab-content" style="display: none;">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for item in viewing_user.reported_items.all %}
            {% if item.type == "Found" %}
            <a class="no-underline block" href="{% url 'view_item' item.id %}">
                <div class="card card-compact bg-base-100 max-w-96 shadow-xl transform transition-transform duration-150 hover:scale-105">
                    <figure class="m-0">
                        <img class="w-full h-40 object-cover" src="{{ item.image.url }}" alt="{{ item.name }}" />
                    </figure>
                    <div class="p-4">
                        <p class="m-0">{{ item.user.username }}</p>
                        <h2 class="text-2xl font-bold">{{ item.name }}</h2>
                        <p class="m-0">{{ item.location }}</p>
                        <p class="m-0 text-sm text-gray-500">Reported: {{ item.date|date:"F d, Y" }}</p>
                    </div>
                </div>
            </a>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<script>
    function openTab(tabName) {
        var i, tabContent, tabLinks;
        tabContent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabContent.length; i++) {
            tabContent[i].style.display = "none";
        }
        tabLinks = document.getElementsByClassName("tab");
        for (i = 0; i < tabLinks.length; i++) {
            tabLinks[i].className = tabLinks[i].className.replace(" tab-active", "");
        }
        document.getElementById(tabName).style.display = "block";
        document.getElementById(tabName + "-tab").className += " tab-active";
    }

    // Show Lost Items tab by default when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        openTab('lost-items');
    });
</script>
{% endblock %}

